import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as c,o as p,c as u,a as n,b as s,d as t,f as a}from"./app-6ac0b3cf.js";const i={},l=a(`<h2 id="å®˜æ–¹æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#å®˜æ–¹æ–‡æ¡£" aria-hidden="true">#</a> å®˜æ–¹æ–‡æ¡£</h2><h3 id="useeffect" tabindex="-1"><a class="header-anchor" href="#useeffect" aria-hidden="true">#</a> useEffect</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">useEffect</span><span class="token punctuation">(</span>didUpdate<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">[</span>dep<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li><p>èµ‹å€¼ç»™ <code>useEffect</code> çš„å‡½æ•° didUpdate ä¼šåœ¨<u>ç»„ä»¶æ¸²æŸ“åˆ°å±å¹•ä¹‹å</u>æ‰§è¡Œã€‚ å³å¾…æµè§ˆå™¨å®Œæˆç”»é¢æ¸²æŸ“ä¹‹åæ‰ä¼šå»¶è¿Ÿè°ƒç”¨ <code>useEffect</code> ã€‚</p></li><li><p>æ¸…é™¤å‡½æ•°ï¼ˆdidUpdateçš„è¿”å›å€¼ï¼‰ã€‚ ä¸ºé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œæ¸…é™¤å‡½æ•°ä¼š<u>åœ¨ç»„ä»¶å¸è½½å‰æ‰§è¡Œ</u>ã€‚ å¦‚æœç»„ä»¶å¤šæ¬¡æ¸²æŸ“ï¼ˆé€šå¸¸å¦‚æ­¤ï¼‰ï¼Œåˆ™<strong>åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ª effect ä¹‹å‰ï¼Œä¸Šä¸€ä¸ª effect å°±å·²è¢«æ¸…é™¤</strong>ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>useEffect(() =&gt; {
  const subscription = props.source.subscribe();
  return () =&gt; {
    // æ¸…é™¤è®¢é˜…
    subscription.unsubscribe();
  };
});
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä¸ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> ä¸åŒçš„æ˜¯ï¼Œåœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸ç»˜åˆ¶<strong>ä¹‹å</strong>ï¼Œä¼ ç»™ <code>useEffect</code> çš„å‡½æ•°<u>ä¼šå»¶è¿Ÿè°ƒç”¨</u>ã€‚</p></li><li><p>è™½ç„¶ <code>useEffect</code> ä¼šåœ¨æµè§ˆå™¨ç»˜åˆ¶åå»¶è¿Ÿæ‰§è¡Œï¼Œä½†ä¼šä¿è¯åœ¨ä»»ä½•æ–°çš„æ¸²æŸ“å‰æ‰§è¡Œã€‚React å°†åœ¨ç»„ä»¶æ›´æ–°å‰åˆ·æ–°ä¸Šä¸€è½®æ¸²æŸ“çš„ effectã€‚</p></li></ol>`,4),d={href:"https://react.docschina.org/docs/hooks-reference.html#useeffect",target:"_blank",rel:"noopener noreferrer"},r=a(`<h3 id="uselayouteffect" tabindex="-1"><a class="header-anchor" href="#uselayouteffect" aria-hidden="true">#</a> useLayoutEffect</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>useLayoutEffect(didUpdate[,[dep]]);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>â€‹ å…¶å‡½æ•°ç­¾åä¸ <code>useEffect</code> ç›¸åŒï¼Œä½†å®ƒ<u>ä¼šåœ¨æ‰€æœ‰çš„ DOM å˜æ›´ä¹‹ååŒæ­¥è°ƒç”¨ effect</u>ã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥<u><strong>è¯»å– DOM å¸ƒå±€å¹¶åŒæ­¥è§¦å‘é‡æ¸²æŸ“</strong></u>ã€‚åœ¨æµè§ˆå™¨æ‰§è¡Œç»˜åˆ¶ä¹‹å‰ï¼ŒuseLayoutEffect å†…éƒ¨çš„æ›´æ–°è®¡åˆ’å°†è¢«åŒæ­¥åˆ·æ–°ã€‚</p><p>â€‹ å°½å¯èƒ½ä½¿ç”¨æ ‡å‡†çš„ useEffect ä»¥é¿å…é˜»å¡è§†è§‰æ›´æ–°ã€‚</p>`,4),k=a("<p><strong>æç¤º</strong></p><p>å¦‚æœä½ æ­£åœ¨å°†ä»£ç ä» class ç»„ä»¶è¿ç§»åˆ°ä½¿ç”¨ Hook çš„å‡½æ•°ç»„ä»¶ï¼Œåˆ™<u>éœ€è¦æ³¨æ„ <code>useLayoutEffect</code> ä¸ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> çš„è°ƒç”¨é˜¶æ®µæ˜¯ä¸€æ ·çš„</u>ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ¨èä½ <strong>ä¸€å¼€å§‹å…ˆç”¨ <code>useEffect</code></strong>ï¼Œåªæœ‰å½“å®ƒå‡ºé—®é¢˜çš„æ—¶å€™å†å°è¯•ä½¿ç”¨ <code>useLayoutEffect</code>ã€‚</p>",2),f={href:"https://react.docschina.org/docs/hooks-reference.html#uselayouteffect",target:"_blank",rel:"noopener noreferrer"},v=a(`<h2 id="æœ€å¤§çš„ä¸åŒ" tabindex="-1"><a class="header-anchor" href="#æœ€å¤§çš„ä¸åŒ" aria-hidden="true">#</a> æœ€å¤§çš„ä¸åŒ</h2><p><strong>è°ƒç”¨æ—¶æœºçš„ä¸åŒ</strong></p><ol><li><code>useLayoutEffect</code> ä¸ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> çš„è°ƒç”¨é˜¶æ®µæ˜¯ä¸€æ ·çš„ã€‚</li><li>åœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸ç»˜åˆ¶<strong>ä¹‹å</strong>ï¼Œä¼ ç»™ <code>useEffect</code> çš„å‡½æ•°ä¼šå»¶è¿Ÿè°ƒç”¨ã€‚</li></ol><p>ğŸŒ°ä¸¾ä¾‹è¯´æ˜useEffectå’ŒuseLayoutEffectçš„è°ƒç”¨æ—¶æœºä¸åŒï¼š</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token comment">// Parent.jsx</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Child <span class="token keyword">from</span> <span class="token string">&quot;./Child&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;[Parent] componentDidMount&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Child</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Child.jsx</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useLayoutEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;[Child] useEffect mount&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useLayoutEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;[Child] useLayoutEffect mount&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Child</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ğŸ™‹ <em><strong>Answerï¼š</strong></em> ä¸Šè¿°æ¡ˆä¾‹çš„æ—¥å¿—ç»“æœå¦‚ä¸‹ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[Child] useLayoutEffect mount   // å­ç»„ä»¶æŒ‚è½½å®Œæˆ
[Parent] componentDidMount		// çˆ¶ç»„ä»¶æŒ‚è½½å®Œæˆ
[Child] useEffect mount			// useEffectå»¶è¿Ÿè°ƒç”¨äº†
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨uselayouteffect" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨uselayouteffect" aria-hidden="true">#</a> ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨useLayoutEffectï¼Ÿ</h2><p>åœ¨æµè§ˆå™¨æ‰§è¡Œä¸‹ä¸€æ¬¡ç»˜åˆ¶å‰ï¼Œç”¨æˆ·å¯è§çš„ DOM å˜æ›´å¿…é¡»åŒæ­¥æ‰§è¡Œï¼Œè¿™æ ·ç”¨æˆ·æ‰ä¸ä¼šæ„Ÿè§‰åˆ°è§†è§‰ä¸Šçš„ä¸ä¸€è‡´ ã€‚</p>`,9);function m(h,g){const e=c("ExternalLinkIcon");return p(),u("div",null,[l,n("p",null,[s("è¯¦è§"),n("a",d,[s("useLayoutEffect"),t(e)])]),r,n("blockquote",null,[k,n("p",null,[s("......æœåŠ¡ç«¯æ¸²æŸ“ç›¸å…³å†…å®¹ï¼Œè¯¦è§"),n("a",f,[s("useLayoutEffect"),t(e)])])]),v])}const y=o(i,[["render",m],["__file","useEffectå’ŒuseLayoutEffectçš„åŒºåˆ«.html.vue"]]);export{y as default};
