import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as c,c as l,a as n,b as s,d as t,e as a}from"./app-d2657418.js";const i={},u=a(`<h2 id="ä½ å¯¹-react-fiber-æœ‰äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#ä½ å¯¹-react-fiber-æœ‰äº†è§£å—" aria-hidden="true">#</a> ä½ å¯¹ react-fiber æœ‰äº†è§£å—ï¼Ÿ</h2><ol><li>å¯¹äº react åŸç†çš„äº†è§£ã€‚</li><li>å¯¹äºæ–°æŠ€æœ¯çš„æ•æ„Ÿç¨‹åº¦ï¼Œæ±‚çŸ¥æ¬²ã€‚</li></ol><h3 id="ç›®çš„" tabindex="-1"><a class="header-anchor" href="#ç›®çš„" aria-hidden="true">#</a> ç›®çš„</h3><ul><li>ä¸ºäº†ä½¿ react æ¸²æŸ“çš„è¿‡ç¨‹å¯ä»¥è¢«<strong>ä¸­æ–­</strong>ï¼Œå¯ä»¥å°†æ§åˆ¶æƒäº¤è¿˜ç»™æµè§ˆå™¨ï¼Œå¯ä»¥è®©ä½ç»™<strong>é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡</strong>ï¼Œæµè§ˆå™¨ç©ºé—²åå†æ¢å¤æ¸²æŸ“ã€‚</li><li>å¯¹äºè®¡ç®—é‡æ¯”è¾ƒå¤§çš„ js è®¡ç®—æˆ–è€… dom è®¡ç®—ï¼Œå°±ä¸ä¼šæ˜¾å¾—ç‰¹åˆ«çš„å¡é¡¿ï¼Œè€Œæ˜¯ä¸€å¸§ä¸€å¸§çš„æœ‰è§„å¾‹çš„æ‰§è¡Œä»»åŠ¡ã€‚</li></ul><p>ğŸŒ° ä¸­æ–­</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å¤šä¸ªä»»åŠ¡ åŒæ­¥</span>

<span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> task<span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>task <span class="token operator">=</span> tasks<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">execute</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿™é‡Œæ‰§è¡Œexecuteéœ€è¦5ç§’å·¦å³æ—¶é—´</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ç§å°±ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæ¯ä¸€ä¸ªä»»åŠ¡éƒ½éœ€è¦å¤§çº¦ 5 ç§’æ—¶é—´ï¼Œé‚£å°±ä¼šå¯¼è‡´é˜»å¡ã€‚<br> å¦‚æœåœ¨æŸä¸ªä»»åŠ¡å¤„åœæ­¢å•¦ï¼Ÿ</p>`,7),r={id:"ä½¿ç”¨-generator-æ¨¡æ‹Ÿä¸­æ–­",tabindex:"-1"},k=n("a",{class:"header-anchor",href:"#ä½¿ç”¨-generator-æ¨¡æ‹Ÿä¸­æ–­","aria-hidden":"true"},"#",-1),d={href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Generator",target:"_blank",rel:"noopener noreferrer"},v=a(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å¤šä¸ªä»»åŠ¡ åŒæ­¥</span>

<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> task<span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>task <span class="token operator">=</span> tasks<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasHighPriorityTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">execute</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿™é‡Œæ‰§è¡Œexecuteéœ€è¦5ç§’å·¦å³æ—¶é—´</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> iterator <span class="token operator">=</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ¢å¤</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¾¹çš„ä»£ç ç®€å•çš„å®ç°äº†ä¸­æ–­ä»»åŠ¡å¹¶å¯æ¢å¤ã€‚</p><p><strong>ğŸ¤”Questionï¼š</strong> æ—¢ç„¶ generator æœ‰ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä¸ºä»€ä¹ˆ react ä¸ç”¨ å•¦ï¼Ÿ</p><ol><li><p>éœ€è¦ç”¨ generator å°†æ¶‰åŠåˆ°çš„æ‰€æœ‰çš„ä»£ç éƒ½åŒ…è£…æˆ generator * å½¢å¼ï¼Œéå¸¸éº»çƒ¦ï¼Œå·¥ä½œé‡æ¯”è¾ƒå¤§ã€‚</p></li><li><p>generator å†…éƒ¨æ˜¯æœ‰çŠ¶æ€çš„</p></li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">doWork</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">doExpensiveWorkA</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// xçš„å€¼ä¾èµ–a</span>
  <span class="token keyword">yield</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token function">doExpensiveWorkA</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¾èµ–xçš„å€¼</span>
  <span class="token keyword">return</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// å‡è®¾doExpensiveWorkAä½œç”¨æ˜¯å°†ä¼ å…¥çš„å‚æ•°ç›¸åŠ åå¹¶è¿”å›ç»“æœã€‚</span>
<span class="token keyword">let</span> m <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
  n <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> working <span class="token operator">=</span> <span class="token function">doWork</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
working<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x = m = 1</span>

m <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">//å¦‚æœè¿™é‡Œæ”¹å˜äº†mï¼Œä½†æ˜¯xå·²ç»doneäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æ²¿ç”¨æ—§çš„xå€¼ã€‚</span>
working<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// y = x + b = a + b = m + n;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¦‚ä½•åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰é«˜ä¼˜å…ˆçº§ä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰é«˜ä¼˜å…ˆçº§ä»»åŠ¡" aria-hidden="true">#</a> å¦‚ä½•åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼Ÿ</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç™½çš„æ˜¯ï¼Œå½“å‰ js çš„ç¯å¢ƒå…¶å®å¹¶æ²¡æœ‰åŠæ³•å»åˆ¤æ–­æ˜¯å¦æœ‰é«˜ä¼˜ä»»åŠ¡ã€‚<strong>ğŸ¤”Questionï¼š</strong> é‚£ä½ ä¼šæ€ä¹ˆå®ç°æˆ–è€…æ¨¡æ‹Ÿä¸€ä¸ªå•¦ï¼Ÿ</p>`,7),m=n("li",null,[n("p",null,"åªèƒ½çº¦å®šä¸€ä¸ªåˆç†çš„æ‰§è¡Œæ—¶é—´ï¼Œå½“è¶…è¿‡è¿™ä¸ªæ‰§è¡Œæ—¶é—´ï¼Œå¦‚æœä»»åŠ¡ä»»ç„¶æ²¡æœ‰æ‰§è¡Œå®Œæˆï¼Œé‚£å°±ä¸­æ–­å½“å‰ä»»åŠ¡ï¼Œå°†æ§åˆ¶æƒäº¤è¿˜ç»™æµè§ˆå™¨ã€‚"),n("p",null,[s("æ™®éçš„æ˜¾ç¤ºå™¨éƒ½æ˜¯æ¯ç§’ 60 å¸§ï¼Œ"),n("strong",null,"1000ms / 60fps = 16ms"),s("ã€‚å¤§æ¦‚å°±æ˜¯ä¸€å¸§çš„æ—¶é—´å¤§çº¦æ˜¯ 16 æ¯«ç§’ã€‚")])],-1),b={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestIdleCallback",target:"_blank",rel:"noopener noreferrer"},h=n("strong",null,"æµè§ˆå™¨ç©ºé—²æ—¶æœŸ",-1),g=n("p",null,"å¹¶ä¸” callback å‡½æ•°ä¼šæ¥æ”¶åˆ°ä¸€ä¸ªåä¸º IdleDeadline çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥è·å–å½“å‰ç©ºé—²æ—¶é—´ä»¥åŠå›è°ƒæ˜¯å¦åœ¨è¶…æ—¶æ—¶é—´å‰å·²ç»æ‰§è¡Œçš„çŠ¶æ€ã€‚",-1),_=a("<li><p>æµè§ˆå™¨åœ¨ä¸€å¸§å†…è¦åšä»€ä¹ˆäº‹æƒ…ï¼Ÿ</p><ol><li>å¤„ç†ç”¨æˆ·è¾“å…¥äº‹ä»¶</li><li>JS çš„æ‰§è¡Œ</li><li>requestAnimation è°ƒç”¨</li><li>å¸ƒå±€ layout</li><li>ç»˜åˆ¶ paint</li></ol><blockquote><p>16ms ä¸€å¸§æ—¶é—´å†…ï¼Œæµè§ˆå™¨å°±æ²¡æœ‰ç©ºé—²æ—¶é—´ï¼Œ<br> å³ 0ms -&gt; requestIdleCallback å°†æ²¡æœ‰æ—¶é—´è¢«è°ƒç”¨<br> é‚£ä¸€ç›´éƒ½æ²¡æœ‰ç©ºé—²æ—¶é—´å•¦ï¼Ÿ</p></blockquote></li>",1),f=n("p",null,"æµè§ˆå™¨å¾ˆå¿™æ€ä¹ˆåŠï¼Ÿï¼ˆç©ºé—²æ—¶é—´ä¸º 0ï¼‰",-1),x={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestIdleCallback",target:"_blank",rel:"noopener noreferrer"},w=n("strong",null,"{ timeout: 100 }",-1),y=a(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    <span class="token comment">//å¦‚æœæŒ‡å®šäº†timeoutï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæ­£å€¼ï¼Œè€Œå›è°ƒåœ¨timeoutæ¯«ç§’è¿‡åè¿˜æ²¡æœ‰è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆå›è°ƒä»»åŠ¡å°†æ”¾å…¥äº‹ä»¶å¾ªç¯ä¸­æ’é˜Ÿï¼Œå³ä½¿è¿™æ ·åšæœ‰å¯èƒ½å¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),q={href:"https://caniuse.com/?search=requestIdleCallback",target:"_blank",rel:"noopener noreferrer"},I=a('<h2 id="è¯´è¯´-react-æ˜¯å¦‚ä½•å®ç°-requestidlecallback-çš„" tabindex="-1"><a class="header-anchor" href="#è¯´è¯´-react-æ˜¯å¦‚ä½•å®ç°-requestidlecallback-çš„" aria-hidden="true">#</a> è¯´è¯´ react æ˜¯å¦‚ä½•å®ç° requestIdleCallback çš„ï¼Ÿ</h2><blockquote><p>é€šè¿‡ messageChannel æ¨¡æ‹Ÿå®ç°</p></blockquote><h2 id="react-ä¸­çš„ä»»åŠ¡ä¼˜å…ˆçº§" tabindex="-1"><a class="header-anchor" href="#react-ä¸­çš„ä»»åŠ¡ä¼˜å…ˆçº§" aria-hidden="true">#</a> react ä¸­çš„ä»»åŠ¡ä¼˜å…ˆçº§ï¼Ÿ</h2><p>5 ä¸ªä¼˜å…ˆçº§ï¼š</p><ol><li><strong>Immediate</strong> æœ€é«˜ä¼˜å…ˆçº§ï¼Œè¿™ä¸ªä¼˜å…ˆçº§çš„ä»»åŠ¡åº”è¯¥é©¬ä¸Šè¢«æ‰§è¡Œï¼Œä¸”ä¸èƒ½ä¸­æ–­ï¼›</li><li><strong>UserBlocking</strong> è¿™äº›ä»»åŠ¡ä¸€èˆ¬æ˜¯ç”¨æˆ·äº¤äº’çš„ç»“æœï¼Œéœ€è¦åŠæ—¶å¾—åˆ°åé¦ˆï¼›</li><li><strong>Normal</strong> ä¸éœ€è¦ç”¨æˆ·ç«‹åˆ»èƒ½æ„Ÿå—åˆ°çš„å˜åŒ–ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ç­‰ï¼›</li><li><strong>Low</strong> è¿™äº›ä»»åŠ¡å¯ä»¥è¢«å»¶åï¼Œä½†æ˜¯æœ€ç»ˆä¹Ÿéœ€è¦è¢«æ‰§è¡Œï¼›</li><li><strong>Idle</strong> å¯ä»¥è¢«æ— é™æœŸå»¶åï¼Œæ¯”å¦‚ console</li></ol><blockquote><blockquote><blockquote><p>åŒä¸€çº§åˆ«çš„ä»»åŠ¡ï¼Œå…ˆåé¡ºåº</p></blockquote></blockquote></blockquote>',6);function j(C,W){const e=p("ExternalLinkIcon");return c(),l("div",null,[u,n("h3",r,[k,s(),n("a",d,[s("ä½¿ç”¨ generator æ¨¡æ‹Ÿä¸­æ–­"),t(e)])]),v,n("ul",null,[m,n("li",null,[n("p",null,[n("a",b,[s("requestIdleCallback(callback[, options])"),t(e)]),s(" : callback å‡½æ•°å°†åœ¨"),h,s("è¢«è°ƒç”¨ã€‚")]),g]),_,n("li",null,[f,n("p",null,[n("a",x,[s("requestIdleCallback(callback[, options])"),t(e)]),s(" ç¬¬äºŒä¸ªå‚æ•° "),w]),y])]),n("blockquote",null,[n("blockquote",null,[n("blockquote",null,[n("p",null,[n("a",q,[s("requestIdelCallback çš„å…¼å®¹æ€§"),t(e)]),s(" å¾ˆå·®")])])])]),I])}const A=o(i,[["render",j],["__file","ã€æºç ã€‘fiber.html.vue"]]);export{A as default};
